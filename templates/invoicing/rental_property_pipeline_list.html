{% extends "base.html" %}

{% block title %}Property Pipeline{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0">Property Pipeline</h2>
    <a class="btn btn-outline-secondary" href="{% url 'homes_dashboard' %}">Back to Dashboard</a>
    </div>

<div class="card shadow-sm mb-3">
    <div class="card-body">
        <div class="d-flex justify-content-between align-items-center mb-2">
            <div class="btn-group" role="group" aria-label="Filter">
                <a class="btn btn-sm {% if status_filter == 'interested' %}btn-primary{% else %}btn-outline-primary{% endif %}" href="?status=interested">Interested</a>
                <a class="btn btn-sm {% if status_filter == 'sold' %}btn-primary{% else %}btn-outline-primary{% endif %}" href="?status=sold">Sold</a>
                <a class="btn btn-sm {% if status_filter == 'not_interested' %}btn-primary{% else %}btn-outline-primary{% endif %}" href="?status=not_interested">Not Interested</a>
            </div>
        </div>
        <form method="post" class="row g-2 align-items-end">
            {% csrf_token %}
            <div class="col-md-4">URL {{ form.url }}</div>
            <div class="col-md-3">TITLE {{ form.title }}</div>
            <div class="col-md-4">NOTES {{ form.notes }}</div>
            <div class="col-md-1"><button class="btn btn-success w-100" type="submit">Add</button></div>
        </form>
    </div>
</div>

<div class="card shadow-sm">
    <div class="table-responsive">
        <table class="table table-striped table-hover mb-0">
            <thead class="table-light">
            <tr>
                <th>Title</th>
                <th>URL</th>
                <th>Notes</th>
                <th>Status</th>
                <th class="text-end">Actions</th>
            </tr>
            </thead>
            <tbody>
            {% for item in items %}
                <tr>
                    <td>{{ item.title|default:"â€”" }}</td>
                    <td><a href="{{ item.url }}" target="_blank" rel="noopener">Link</a></td>
                    <td class="small text-muted">{{ item.notes|default:"" }}</td>
                    <td>{{ item.get_status_display }}</td>
                    <td class="text-end">
                        <a class="btn btn-sm btn-outline-secondary" href="{% url 'rental_pipeline_update_status' item.id 'not_interested' %}">Not Interested</a>
                        <a class="btn btn-sm btn-outline-success" href="{% url 'rental_pipeline_update_status' item.id 'sold' %}">Sold</a>
                    </td>
                </tr>
            {% empty %}
                <tr><td colspan="5" class="text-center text-muted">No pipeline items yet.</td></tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}


