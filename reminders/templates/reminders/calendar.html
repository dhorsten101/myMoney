{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2 class="mb-0">Calendar</h2>
  <form method="post" class="d-flex gap-2">
    {% csrf_token %}
    {{ form.title }}
    {{ form.due_at }}
    <button class="btn btn-sm btn-primary">Add</button>
  </form>
</div>
<style>
  #calendar { min-height: 70vh; }
  .fc { font-size: 0.95rem; }
  .fc-toolbar-title { font-size: 1.1rem; }
  .fc .fc-daygrid-day-number { font-size: 0.85rem; }
</style>
<div id="calendar"></div>

<link href='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/main.min.css' rel='stylesheet' />
<script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/main.min.js'></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  var calendarEl = document.getElementById('calendar');
  var calendar = new FullCalendar.Calendar(calendarEl, {
    initialView: 'dayGridMonth',
    events: '/reminders/events/',
    height: 'auto',
    headerToolbar: {
      left: 'prev,next today',
      center: 'title',
      right: 'dayGridMonth,timeGridWeek,timeGridDay'
    },
    eventDidMount: function(info) {
      if (info.event.extendedProps && info.event.extendedProps.severity === 'critical') {
        info.el.style.backgroundColor = '#dc3545';
        info.el.style.borderColor = '#dc3545';
      }
    },
    eventClick: function(info) {
      var props = info.event.extendedProps || {};
      var msg = info.event.title + '\n' + (props.description || '') + '\n' + (props.source || '');
      alert(msg);
    }
  });
  calendar.render();
});
</script>
{% endblock %}


