{% extends "base.html" %}
{% block main_class %}container-fluid{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2 class="mb-0">Calendar</h2>
  <div>
    <a class="btn btn-sm btn-primary" href="{% url 'reminders_new' %}">Add event</a>
  </div>
</div>
<style>
  #calendar { min-height: calc(100vh - 230px); }
  .fc { font-size: 0.95rem; }
  .fc-toolbar-title { font-size: 1.1rem; }
  .fc .fc-daygrid-day-number { font-size: 0.85rem; }
</style>
<div id="calendar"></div>

<link href='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.min.css' rel='stylesheet' />
<script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js'></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  var calendarEl = document.getElementById('calendar');
  var calendar = new FullCalendar.Calendar(calendarEl, {
    initialView: 'dayGridMonth',
    events: '/reminders/events/',
    height: '100%',
    headerToolbar: {
      left: 'prev,next today',
      center: 'title',
      right: 'dayGridMonth,timeGridWeek,timeGridDay'
    },
    eventDidMount: function(info) {
      if (info.event.extendedProps && info.event.extendedProps.severity === 'critical') {
        info.el.style.backgroundColor = '#dc3545';
        info.el.style.borderColor = '#dc3545';
      }
    },
    eventClick: function(info) {
      var props = info.event.extendedProps || {};
      var id = props.id;
      if (id) {
        window.location.href = '/reminders/edit/' + id + '/';
      }
    }
  });
  calendar.render();
});
</script>
{% endblock %}


